<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Tic-Tac-Toe</title>
  <style type="text/css">
    /* Grid Buttons Styling */

    .box {
      width: 100px;
      height: 100px;
      text-align: center;
      font-size: 20px;
      margin: 2px 0px;
      cursor: pointer;
    }

    /* Change Mode, Restart and Hyperlink Buttons Styling */

    .mode,
    .restart,
    .links {
      text-align: center;
      cursor: pointer;
    }

    /* Version Button Styling */

    .version {
      text-align: center;
    }
  </style>
  <script type="text/javascript">
    // Value Flag

    var f = 0;

    // Game Array

    var data = ["", "", "", "", "", "", "", "", ""];

    // Default Game Mode

    var mode = "Player vs Computer";

    // Default Value to Stop or Allow the Bot After Result

    var continue_callback = true;

    // Choose Mode Function

    function change_mode(id) {
      if (mode == "Player vs Computer") {
        mode = "Player vs Player";
        document.getElementById(id).value = "Change Mode: Player vs Player";
      } else if (mode == "Player vs Player") {
        mode = "Player vs Computer";
        document.getElementById(id).value = "Change Mode: Player vs Computer";
      }
      restart();
    }

    // Releases

    function releases() {
      window.open("https://github.com/VarunS2002/JavaScript-Tic-Tac-Toe/releases/", "_blank");
    }

    // Sources

    function sources() {
      window.open("https://github.com/VarunS2002/JavaScript-Tic-Tac-Toe/", "_blank");
    }

    // Restart Function

    function restart() {
      f = 0;
      data = ["", "", "", "", "", "", "", "", ""];
      continue_callback = true;
      for (var x = 0; x < 9; x++) {
        document.getElementById(x).value = " ";
        document.getElementById(x).disabled = false;
        document.getElementById(x).style.cursor = "pointer";
      }
    }


    // Check Result Function

    function check(id) {
      if (id == 0) {
        if (data[0] == data[1] && data[1] == data[2]) {
          result();
          return;
        } else if (data[0] == data[3] && data[3] == data[6]) {
          result();
          return;
        } else if (data[0] == data[4] && data[4] == data[8]) {
          result();
          return;
        }
      } else if (id == 1) {
        if (data[0] == data[1] && data[1] == data[2]) {
          result();
          return;
        } else if (data[1] == data[4] && data[4] == data[7]) {
          result();
          return;
        }
      } else if (id == 2) {
        if (data[0] == data[1] && data[1] == data[2]) {
          result();
          return;
        } else if (data[2] == data[5] && data[5] == data[8]) {
          result();
          return;
        } else if (data[2] == data[4] && data[4] == data[6]) {
          result();
          return;
        }
      } else if (id == 3) {
        if (data[0] == data[3] && data[3] == data[6]) {
          result();
          return;
        } else if (data[3] == data[4] && data[4] == data[5]) {
          result();
          return;
        }
      } else if (id == 4) {
        if (data[1] == data[4] && data[4] == data[7]) {
          result();
          return;
        } else if (data[3] == data[4] && data[4] == data[5]) {
          result();
          return;
        } else if (data[0] == data[4] && data[4] == data[8]) {
          result();
          return;
        } else if (data[2] == data[4] && data[4] == data[6]) {
          result();
          return;
        }

      } else if (id == 5) {
        if (data[2] == data[5] && data[5] == data[8]) {
          result();
          return;
        } else if (data[3] == data[4] && data[4] == data[5]) {
          result();
          return;
        }
      } else if (id == 6) {
        if (data[0] == data[3] && data[3] == data[6]) {
          result();
          return;
        } else if (data[2] == data[4] && data[4] == data[6]) {
          result();
          return;
        } else if (data[6] == data[7] && data[7] == data[8]) {
          result();
          return;
        }
      } else if (id == 7) {
        if (data[6] == data[7] && data[7] == data[8]) {
          result();
          return;
        } else if (data[1] == data[4] && data[4] == data[7]) {
          result();
          return;
        }
      } else if (id == 8) {
        if (data[2] == data[5] && data[5] == data[8]) {
          result();
          return;
        } else if (data[0] == data[4] && data[4] == data[8]) {
          result();
          return;
        } else if (data[6] == data[7] && data[7] == data[8]) {
          result();
          return;
        }
      }

      // Output if Match is Drawn

      if (data.every(element => element != "") == true) {
        setTimeout(function delay_alert() {
          alert("Draw");
        }, 100);

        // Setting Value to Stop the Bot after Result

        if (mode == "Player vs Computer") {
          continue_callback = false;
        }
      }


    }

    // Output the Winner

    function result() {

      // Setting Value to Stop the Bot after Result

      if (mode == "Player vs Computer") {
        continue_callback = false;
      }


      // Displaying the Result

      if (f == 0) {
        if (mode == "Player vs Player") {
          setTimeout(function delay_alert() {
            alert("O won");
          }, 100);
          //alert("O won");
        } else if (mode == "Player vs Computer") {
          setTimeout(function delay_alert() {
            alert("Computer won");
          }, 100);
          //alert("Computer won");
        }


      } else if (f == 1) {
        if (mode == "Player vs Player") {
          setTimeout(function delay_alert() {
            alert("X won");
          }, 100);
          //alert("X won");
        } else if (mode == "Player vs Computer") {
          setTimeout(function delay_alert() {
            alert("You won");
          }, 100);
          //alert("You won");
        }
      }

      // Setting Button Attributes

      for (i = 0; i < 9; i++) {
        document.getElementById(i).disabled = true;
        document.getElementById(i).style.cursor = "default";

      }
    }

    // Choose Value Function

    function callback(id) {
      if (mode == "Player vs Computer")

      // Inputting User's Value

      {
        if (f == 0) {
          if (document.getElementById(id).value == " ") {
            document.getElementById(id).value = "X";
            data[id] = "X";
            f += 1;
          }

          // Calling Check Result Function

          check(id);
        }

        // Stopping the Bot after Result

        if (!continue_callback) {
          return;
        }

        // Inputting Bot's Value

        if (f == 1) {
          while (true) {
            var random_index = Math.floor(Math.random() * 8);
            if (document.getElementById(random_index).value == " ") {
              document.getElementById(random_index).value = "O";
              data[random_index] = "O";
              f -= 1;

              // Calling Check Result Function

              check(random_index);

              break;
            } else {
              continue;
            }
          }
        }
      } else if (mode == "Player vs Player")

      // Inputting User's Value

      {
        if (f == 0) {
          if (document.getElementById(id).value == " ") {
            document.getElementById(id).value = "X";
            data[id] = "X";
            f += 1;
          }
        } else if (f == 1) {
          if (document.getElementById(id).value == " ") {
            document.getElementById(id).value = "O";
            data[id] = "O";
            f -= 1;
          }
        }

        // Calling Check Result Function

        check(id);
      }
    }
  </script>
</head>

<body align="center">

  <?-- Top NavBar Buttons -->

    <nav>
      <input type="button" id="13" value="Change Mode: Player vs Computer" class="mode" onclick="change_mode(this.id)"/>
      <br />
      <input type="button" id="9" value="Restart" class="restart" onclick="restart()"/>
      <br />
    </nav>

    <?-- Grid Buttons -->

    <br />
    <input type="button" id="0" value=" " class="box" onclick="callback(this.id)" />
    <input type="button" id="1" value=" " class="box" onclick="callback(this.id)" />
    <input type="button" id="2" value=" " class="box" onclick="callback(this.id)" />
    <br />
    <input type="button" id="3" value=" " class="box" onclick="callback(this.id)" />
    <input type="button" id="4" value=" " class="box" onclick="callback(this.id)" />
    <input type="button" id="5" value=" " class="box" onclick="callback(this.id)" />
    <br />
    <input type="button" id="6" value=" " class="box" onclick="callback(this.id)" />
    <input type="button" id="7" value=" " class="box" onclick="callback(this.id)" />
    <input type="button" id="8" value=" " class="box" onclick="callback(this.id)" />
    <br />

    <?-- Bottom NavBar Buttons -->

    <nav>
      <br />
      <input type="button" id="10" value="Version : 1.2" class="version" disabled=true/>
      <input type="button" id="11" value="Releases" class="links" onclick="releases()"/>
      <input type="button" id="12" value="Sources" class="links" onclick="sources()" />
    </nav>
</body>
</html>
